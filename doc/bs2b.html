<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Bauer stereophonic-to-binaural DSP</title>
  <meta content="Boris Mikhaylov" name="author">
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);"
 alink="#000099" link="#000099" vlink="#990099">
<table
 style="width: 700px; text-align: left; font-family: times new roman,times,serif;"
 border="0" cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;"><big><big><span
 style="font-weight: bold;">Bauer stereophonic-to-binaural DSP.</span></big></big><br>
      <big><span style="font-weight: bold;"><br>
      <a name="Preface"></a>1.
Preface.</span></big><br>
      <br>
A regular stereo record is produced for listening by loudspeakers. This
means
that sound engineer makes stereo mixing with interpretation of sound
for hearing of one channel by both ears. Therefore, you will be tired
by long time headphone listening more through superstereo effect than
through
bad
headphone design. What&#8217;s missing
in headphones is the sound going from each channel to the opposite ear,
arriving a short time later for the extra distance traveled, and with a
bit of high frequency roll-off for the shadowing effect of the head.
And the time delay to the far
ear is somewhat longer at low frequencies than at high frequencies.
The Bauer stereophonic-to-binaural DSP (<a
 href="http://bs2b.sourceforge.net/" target="_top">bs2b</a>) is
designed to improve headphone listening of stereo audio records. This
improvement have been described well by electronic circuit designers
like
Benjamin Bauer <a href="#r1">[1]</a>, Siegfried Linkwitz <a href="#r2">[2]</a>,
Chu Moy <a href="#r3">[3]</a>, Jan Meier <a href="#r4">[4]</a>, John
Conover <a href="#r10">[10]</a>,
HeadRoom <a href="#r9">[9]</a>.
The time delay at low frequency range, lowpass filters, highboost
filters and crossfeeding of their circuits has been made by first order
RL
(Bauer) or RC
(Linkwitz, Moy, Meier) analog filters. This design makes desired
effects and naturally eliminates comb filter effect at high frequency
range by
nonlinear phase response property of these filters. The bs2b makes the
same job by simple and fast (in comparison with convolution) single
pole recursive digital filters, because
these filters has a properties as an electronic RC-filters <a
 href="#r5">[5]</a>, <a href="#r6">[6]</a>, <a href="#r7">[7]</a>.
I have
select a such values of cutoff frequencies of lowpass and
highboost
filters that allow to get a desired time delay and
most smooth resulting frequency
response. Unfortunately, I did not calculate the real value
of
cutoff
frequency of highboost filter, but it is not so important. A highboost
digital filter can be presented as two-step filter: as a
subtraction of attenuated lowpass filtered signal from original signal.
This
can be mathematically presented to the one-step recursive filter. In
the first (1.0.0) release of bs2b I
was apply a two-step method for highboost filter with using of already
calculated lowpas filtered signal, but it
makes the value of cutoff frequency of highboost filter little
lower than I was
assume, and it leads to a thickness in the lower midrange.
Nevertheless, as Chu Moy wrote <a href="#r3">[3]</a>, the
value of highboost filter cutoff frequency
should be little
higher then lowpass filter one for
more smooth frequency
response of crossfeeder. Therefore, I have made an one-step
method for highboost
filter in second release of bs2b. I was started this project
because the sound of other, I have see before, audioplayer's headphone
plugins have not satisfy me. The primary degradation of sound by
headphone
DSPs is prodiced by a
comb filter effect due to using of FFT convolution with
linear phase response for filtering. There is a <a
 href="http://www.stereo-balance.net/" target="_top">HeadPlug</a>
plugin that have
'decomb' option, and author wrote about it: "The way the plugin does
this is
really damn-ass straight-forward from a technical point of view". I
have
try to make it much easier for CPU. Last
note. The bs2b don't produce simulation of any ambient and don't
produce any HRTF <a href="#r8">[8]</a> transform in high frequency
range. Some implementation of HRTF in the high frequency range is
already have done by
headphones, except
of binaural headphones like <a href="http://www.etymotic.com/"
 target="_top">Etymotic</a> ER-4B.<br>
So, try to use bs2b to feel sound little out from your
head to lighten the work of&nbsp; your brain.<br>
      <br>
      <big><span style="font-weight: bold;"><a name="Theoretical_issue"></a>2.
Theoretical issue.</span></big><br>
      <br>
Single
pole recursive filter is
presented by recursion eqation:<br>
O[n] = a0 * I[n] + a1 * I[n-1] + b1 * O[n-1]<br>
where a0, a1, b1 are recursion coefficients, I[n] is an input samples,
O[n] is an output (filtered) samples. Filter's response is relay to
recursion coefficients. Table 2.1 shows a perl program that calculate
frequency and time delay
responses of bs2b by H-transform <a href="bs2b.html#r5">[5]</a>.<br>
      <br>
      <span style="font-weight: bold;">Table 2.1. bs2b-H-transform.pl.</span><br>
      <table
 style="width: 100%; background-color: rgb(255, 255, 204); text-align: left; font-family: courier new,courier,monospace;"
 border="0" cellpadding="2" cellspacing="2">
        <tbody>
          <tr>
            <td style="vertical-align: top;"><font size="-1">#!/usr/bin/perl<br>
            <br>
use Math::Complex;<br>
            <br>
$s&nbsp;&nbsp;&nbsp; = 40000; # Sample rate (Hz)<br>
            <br>
$Fc&nbsp;&nbsp; = shift; # Lowpass filter cut frequency (Hz)<br>
$Gd&nbsp;&nbsp; = shift; # Lowpass filter gain (dB)<br>
$Ad_h = shift; # Highboost filter gain (dB) (0dB is highs)<br>
            <br>
# example:<br>
# perl bs2b-H-transform.pl 700 -8 -2<br>
# it makes -6 dB crossfeed level<br>
#<br>
# bs2b 2.0.0b uses data listed below.<br>
# perl bs2b-H-transform.pl 700 -5.5&nbsp; -2.5&nbsp; # high crossfeed
level<br>
# perl bs2b-H-transform.pl 500 -6.75 -2.25 # middle crossfeed level<br>
# perl bs2b-H-transform.pl 360 -8&nbsp;&nbsp;&nbsp;
-2&nbsp;&nbsp;&nbsp; # low crossfeed level<br>
            </font><font size="-1"># bs2b 2.1.0 uses additional 'Easy'
data that below.</font><br>
            <font size="-1"># perl bs2b-H-transform.pl 700 -8
-2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font size="-1"># high
easy crossfeed
level</font><br>
            <font size="-1"># perl bs2b-H-transform.pl 500 -9 -1.8</font><font
 size="-1">&nbsp;&nbsp;&nbsp;&nbsp; # middle</font><font size="-1"> easy</font><font
 size="-1"> crossfeed level</font><br>
            <font size="-1"># perl bs2b-H-transform.pl 360 -10 -1.6</font><font
 size="-1">&nbsp;&nbsp;&nbsp; # low</font><font size="-1"> easy</font><font
 size="-1"> crossfeed level</font><br>
            <font size="-1"><br>
            <br>
$G&nbsp;&nbsp;&nbsp; = 10 ** ($Gd / 20);<br>
$A_h&nbsp; = 10 ** ($Ad_h / 20);<br>
$G_h&nbsp; = 1 - $A_h;<br>
            <br>
$Gd_h = 20 * log($G_h) / log(10);<br>
$Fc_h = $Fc * (2 ** (($Gd - $Gd_h) / 12)); # '/3' by my theory, but...<br>
            <br>
print "Fc_low = $Fc\nFc_high = $Fc_h\n";<br>
print "G = $G\nG_h = $G_h\n";<br>
            <br>
$fc&nbsp;&nbsp; = $Fc / $s;<br>
$d&nbsp;&nbsp;&nbsp; = 1 / 2 / pi / $fc;<br>
$x&nbsp;&nbsp;&nbsp; = exp(-1 / $d);<br>
            <br>
$fc_h = $Fc_h / $s;<br>
$d_h&nbsp; = 1 / 2 / pi / $fc_h;<br>
$x_h&nbsp; = exp(-1 / $d_h);<br>
            <br>
# Lowpass single pole filter coefficients<br>
$b1&nbsp;&nbsp; = $x;<br>
$a0&nbsp;&nbsp; = $G * (1 - $x);<br>
$a1&nbsp;&nbsp; = 0;<br>
            <br>
# Highboost single pole filter coefficients<br>
$b1_h = $x_h;<br>
$a0_h = 1 - $G_h * (1 - $x_h);<br>
$a1_h = -$x_h;<br>
            <br>
$w0 = 2 * pi * 4 / $s / 1.15;<br>
$z = exp(i * $w0);<br>
$H0&nbsp;&nbsp; = ($a0&nbsp;&nbsp; + $a1&nbsp;&nbsp; / $z) / (1 -
$b1&nbsp;&nbsp; / $z);<br>
$H0_h = ($a0_h + $a1_h / $z) / (1 - $b1_h / $z);<br>
            <br>
for ($w = $w0 * 1.15; $w &lt;= pi/2; $w0 = $w, $w *= 1.15)<br>
{<br>
&nbsp;&nbsp;&nbsp; $z = exp(i * $w);<br>
&nbsp;&nbsp;&nbsp; $H&nbsp;&nbsp; = ($a0&nbsp;&nbsp; + $a1&nbsp;&nbsp;
/ $z) / (1 - $b1&nbsp;&nbsp; / $z);<br>
&nbsp;&nbsp;&nbsp; $H_h = ($a0_h + $a1_h / $z) / (1 - $b1_h / $z);<br>
            <br>
&nbsp;&nbsp;&nbsp; $str = sprintf("%f\t%f\t%f\t%f\t%f\t%f\t%f\n",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s * $w / 2 / pi,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rho($H),&nbsp;&nbsp;&nbsp; #
20 * log(rho($H)) / log(10) (dB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; theta($H) * 180 /
pi,&nbsp;&nbsp;&nbsp; # degree<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (theta($H) - theta($H0)) /
($w - $w0) * 1000000 / $s,&nbsp;&nbsp;&nbsp;&nbsp; # mcs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rho($H_h),&nbsp; # 20 *
log(rho($H_h)) / log(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; theta($H_h) * 180 /
pi,&nbsp; # degree<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (theta($H_h) - theta($H0_h))
/ ($w - $w0) * 1000000 / $s&nbsp; # mcs<br>
&nbsp;&nbsp;&nbsp; );<br>
            <br>
&nbsp;&nbsp;&nbsp; $str =~ s/\./\,/g; # Russian locale<br>
&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; print $str;<br>
            <br>
&nbsp;&nbsp;&nbsp; $H0&nbsp;&nbsp; = $H;<br>
&nbsp;&nbsp;&nbsp; $H0_h = $H_h;<br>
}<br>
            </font> </td>
          </tr>
        </tbody>
      </table>
      <br>
Pictures 2.1 and 2.2 shows a results of above program. In other words,
there is a theoretical responses of bs2b DSP. Only low crossfeed level
'-L' and high crossfeed level '-H' presets of bs2b are shown. Middle
crossfeed level preset is omitted for clearness. 'HB' is highboost
filter. 'LP' is lowpass filter. 'M' is a sum of these filtered signals,
that can be interpreted as bs2b action to a two channel mono signal.<br>
      <br>
      <span style="font-weight: bold;">Picture 2.1. bs2b theoretical
frequency
response.</span><br>
      <img alt="bs2b theoretical frequency response"
 src="img/bs2b_h-trans_f.png" style="width: 679px; height: 489px;"><br>
      <br>
At picture 2.2 a negative value of time presents delay of signal by
microseconds.<br>
      <br>
      <span style="font-weight: bold;">Picture 2.2. bs2b theoretical
time delay response.</span><br>
      <img alt="bs2b theoretical time delay response"
 src="img/bs2b_h-trans_d.png" style="width: 680px; height: 293px;"><br>
      <br>
This responses looks as a virtual stereo speakers are moved from
30
degrees
azimuth (high crossfeed level) to 60 degrees azimuth (low crossfeed
level).<br>
      <br>
Pictures 2.3 and 2.4 shows a results of above program for new 'Easy'
crossfeed levels of 2.1 release of bs2b. Only low-easy crossfeed level
'-L' and high-easy crossfeed level '-H' presets of bs2b are shown.<br>
      <br>
      <span style="font-weight: bold;">Picture 2.3. bs2b theoretical
frequency
response. 'Easy' version.</span><br>
      <img alt="bs2b theoretical frequency response. 'Easy' version"
 src="img/bs2b_h_e-trans_f.png" style="width: 679px; height: 489px;"><br>
      <br>
The high-easy preset is close to Chu Moy's <a href="bs2b.html#r3">[3]</a>
version of crossfeeder.<br>
Picture 2.4 presents delay response of 'Easy' version.<br>
      <br>
      <span style="font-weight: bold;">Picture 2.4. bs2b theoretical
time delay response. 'Easy' version.</span><br>
      <img alt="bs2b theoretical time delay response. 'Easy' version"
 src="img/bs2b_h_e-trans_d.png" style="width: 680px; height: 293px;"><br>
      <br>
This responses looks close to noneasy version because of the same
set of cutoff frequencies of lowpass filters and little differences of
highboost filters for both versions.<br>
      <br>
      <big><span style="font-weight: bold;"><a name="Practical_data"></a>3.
Practical data.<br>
      </span></big><br>
Picture 3.1 shows the practical frequency responses of
bs2b. This is a frequency analysis of applied to
bs2b white noise signals. There
are two channel mono signal 'M', two channel independ signal 'I' and
one channel signal. The bs2b processing of one channel signal is
presented as highboost filtered 'HB' or channel with primary signal and
as
lowpass filtered 'LP' or channel without primary signal. Only low
crossfeed
level '-L' and high crossfeed level '-H' presets of
bs2b are shown. Middle crossfeed level preset is omitted for clearness.<br>
      <br>
      <span style="font-weight: bold;">Picture 3.1. bs2b frequency
response.</span><br>
      <img alt="bs2b frequency response" src="img/bs2b_exdata_f.png"
 style="width: 678px; height: 488px;"><br>
      <br>
Picture 3.2 shows the difference between
frequency analysis of real audio
program and
frequency analysis of that program has been processed by bs2b.<br>
      <br>
      <span style="font-weight: bold;">Picture 3.2. J.S. Bach
"BWV1066"
"Overture" frequency analysis difference.</span><br>
      <img
 alt="J.S. Bach &quot;BWV1066&quot; &quot;Overture&quot; frequency analysis difference"
 src="img/Bach-BWV1066-Overture-diff.png"
 style="width: 681px; height: 294px;"><br>
      <br>
Picture 3.3 shows the practical frequency responses of 'Easy High'
preset of
bs2b.<br>
      <br>
      <span style="font-weight: bold;">Picture 3.3. bs2b frequency
response</span><span style="font-weight: bold;">. 'Easy' version</span><span
 style="font-weight: bold;">.</span><br>
      <img alt="bs2b frequency response. 'Easy' version"
 src="img/bs2b_e_exdata_f.png" style="width: 678px; height: 488px;"><br>
      <br>
Picture 3.4 is like picture 3.2 but for 'Easy High' ('-H') and 'Easy
Low' ('-L') presets.<br>
      <br>
      <span style="font-weight: bold;">Picture 3.4. J.S. Bach
"BWV1066"
"Overture" frequency analysis difference</span><span
 style="font-weight: bold;">. 'Easy' version</span><span
 style="font-weight: bold;">.</span><br>
      <img
 alt="J.S. Bach &quot;BWV1066&quot; &quot;Overture&quot; frequency analysis difference. 'Easy' version"
 src="img/Bach-BWV1066-Overture-diff_e.png"
 style="width: 681px; height: 294px;"><br>
      <br>
      <br>
      <big><span style="font-weight: bold;"><a name="References"></a>4.
References.</span></big><br>
      <br>
      <a name="r1"></a>[1] &nbsp;Benjamin B. Bauer. Stereophonic
Earphones
and
Binaural Loudspeakers.<br>
      <div style="margin-left: 40px;">JAES Volume 9
Number 2 pp. 148-151; April 1961. <a href="http://www.aes.org/"
 target="_top">http://www.aes.org/</a><br>
      </div>
      <br>
      <a name="r2"></a>[2] &nbsp;Siegfried Linkwitz. Improved Headphone
Listening. Build a stereo-crossfeed circuit.<br>
      <div style="margin-left: 40px;">Audio; December 1971. <a
 href="http://www.linkwitzlab.com/" target="_top">http://www.linkwitzlab.com/</a><br>
      </div>
      <br>
      <a name="r3"></a>[3] &nbsp;Chu Moy. An Acoustic Simulator for
Headphone
Amplifiers.<br>
      <div style="margin-left: 40px;">(C) 1998-2001 Chu Moy. <a
 href="http://headwize.com/projects/showfile.php?file=cmoy1_prj.htm"
 target="_top">http://headwize.com/projects/showfile.php?file=cmoy1_prj.htm</a><br>
      </div>
      <br>
      <a name="r4"></a>[4] &nbsp;Jan Meier. A DIY Headphone Amplifier.<br>
      <div style="margin-left: 40px;"><a
 href="http://www.meier-audio.de/" target="_top">http://www.meier-audio.de/</a>, <a href="http://bs2b.sourceforge.net/ARIETTA/index.html">CORDA ARIETTA</a><br>
      </div>
      <br>
      <a name="r5"></a>[5] &nbsp;Steven W. Smith, Ph.D. The Scientist
and
Engineer's Guide to Digital Signal Processing.<br>
      <div style="margin-left: 40px;">California Technical
Publishing; ISBN 0-9660176-3-3 (1997). <a
 href="http://www.dspguide.com/" target="_top">http://www.dspguide.com/</a><br>
      </div>
      <br>
      <a name="r6"></a>[6] &nbsp;Davide Rocchesso. Introduction to
Sound
Processing.<br>
      <div style="margin-left: 40px;">(C) 2003 Davide Rocchesso, GNU
FDL. <a href="http://profs.sci.univr.it/%7Erocchess" target="_top">http://profs.sci.univr.it/~rocchess</a><br>
      </div>
      <br>
      <a name="r7"></a>[7] &nbsp;BORES Signal Processing: Introduction
to
DSP.<br>
      <div style="margin-left: 40px;">(C) 2004 Bores Signal Processing.
      <a href="http://www.bores.com/courses/intro/index.htm"
 target="_top">http://www.bores.com/courses/intro/index.htm</a><br>
      </div>
      <br>
      <a name="r8"></a>[8] &nbsp;Richard O.Duda. 3-D Audio for HCI.<br>
      <div style="margin-left: 40px;">(C)
1996-2000 Richard O.Duda. <a href="http://interface.cipic.ucdavis.edu/"
 target="_top">http://interface.cipic.ucdavis.edu/</a><br>
      </div>
      <br>
      <a name="r9"></a>[9]&nbsp; HeadRoom. About the HeadRoom
Crossfeed.<br>
      <div style="margin-left: 40px;">(C) 1995-2006 HeadRoom. <a
 href="http://www.headphone.com/products/faqs/about-headroom-crossfeed/"
 target="_top">http://www.headphone.com/products/faqs/about-headroom-crossfeed/</a><br>
      </div>
      <br>
      <a name="r10"></a>[10]&nbsp; John Conover. Spatial Distortion
Reduction Headphone Amplifier.<br>
      <div style="margin-left: 40px;">(C) 1992-2005 John Conover. <a
 href="http://www.johncon.com/john/SSheadphoneAmp/index.html"
 target="_top">http://www.johncon.com/john/SSheadphoneAmp/index.html</a><br>
      </div>
      <br>
      <hr style="width: 100%; height: 2px;">Copyright (c) 2006&nbsp;
Boris Mikhaylov &lt; <a href="http://www.tmn.ru/%7Ebor" target="_top">http://www.tmn.ru/~bor</a>&gt;</td>
    </tr>
  </tbody>
</table>
</body>
</html>
